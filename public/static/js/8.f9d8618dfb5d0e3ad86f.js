webpackJsonp([8],{KyAU:function(t,e){},LbJp:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"news",components:{pagination:a("spLH").a},data:function(){return{tableData:[],dialogTableVisible:!1,formData:{title:"",_id:"",priority:1,pic:""},token:"",params:{pageSize:5,page:1}}},methods:{getdata:function(){var t=this;this.$axios.post("getNews",this.params).then(function(e){t.tableData=e.data,console.log(new Date(e.data[0].createdAt))})},delData:function(t){var e=this;this.$confirm("此操作将永久删除该新闻, 是否继续?","提示",{cancelButtonText:"取消",confirmButtonText:"确定",type:"warning"}).then(function(){e.$axios.post("delNews",{id:t}).then(function(t){200==t.code&&(e.$message({message:"新闻删除成功",type:"success"}),setTimeout(function(){e.$router.go(0)},1e3))})}).catch(function(){console.log(res.err)})},create:function(t){var e=this;this.$axios.post("getNews",{id:t}).then(function(t){e.formData=t.data[0]})},submit:function(){var t=this;console.log(this.formData),this.$axios.post("addslideShows",this.formData).then(function(e){200==e.code?t.$message({message:"图片添加成功",type:"success"}):t.$message({message:e.msg,type:"warning"})})},edit:function(t){this.$router.push({path:"/crmnews/update",query:{id:t}})},upload:function(t){this.formData.pic="http://image.yaojunrong.com/"+t.key},getToken:function(){var t=this;this.$axios.qiniuGet().then(function(e){t.token=e.data})},pageSizeChange:function(t){this.params.pageSize=t,this.getdata()},currentPageChange:function(t){this.params.page=t,this.getdata()}},created:function(){var t=this;this.$nextTick(function(){t.getdata(),t.getToken()})}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{label:"头图",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticClass:"img-item",attrs:{src:t.row.img}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"标题"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.title))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.type))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"发布时间"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.createdAt))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.edit(e.row._id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.delData(e.row._id)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.create(e.row._id),t.dialogTableVisible=!0}}},[t._v("生成轮播图")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"添加轮播图",visible:t.dialogTableVisible,width:"80%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"100px",size:"small"}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"跳转链接"}},[a("el-input",{model:{value:t.formData._id,callback:function(e){t.$set(t.formData,"_id",e)},expression:"formData._id"}}),t._v(" "),a("p",{staticStyle:{color:"#ff6700","font-size":"12px"}},[t._v("可填写页面地址，也可填写页面id(新闻列表里)")])],1),t._v(" "),a("el-form-item",{attrs:{label:"优先级"}},[a("el-input-number",{attrs:{size:"small",min:1,max:10,label:"优先级"},model:{value:t.formData.priority,callback:function(e){t.$set(t.formData,"priority",e)},expression:"formData.priority"}}),t._v(" "),a("p",{staticStyle:{color:"#ff6700","font-size":"12px"}},[t._v("值越大，图片显示越靠前")])],1),t._v(" "),a("el-form-item",{attrs:{label:"图片上传"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"https://upload-z1.qiniup.com","show-file-list":!1,"on-success":t.upload,data:{token:t.token}}},[t.formData.pic?a("img",{staticClass:"avatar",attrs:{src:t.formData.pic}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:t.submit}},[t._v("保存")])],1)],1)],1),t._v(" "),a("pagination",{on:{pageSizeChange:t.pageSizeChange,currentPageChange:t.currentPageChange}})],1)},staticRenderFns:[]};var o=a("VU/8")(i,n,!1,function(t){a("Xgcy"),a("KyAU")},"data-v-3ec6ea82",null);e.default=o.exports},Xgcy:function(t,e){}});
//# sourceMappingURL=8.f9d8618dfb5d0e3ad86f.js.map